function ValidatePhone(e){var a=new RegExp("[0-9-+]"),t=String.fromCharCode(e.charCode?e.which:e.charCode);return a.test(t)?void 0:(e.preventDefault(),!1)}function removeClassT(e){$("#appMenu li").each(function(e,a){$(a).hasClass("transition")||$(a).addClass("transition")}),$("li#"+e).removeClass("transition")}function getOrganizationData(e){orgData=_glocalStorage.loadData("orgdata"),loginData=_glocalStorage.loadData("login"),void 0==orgData&&(orgData=_gUserService.GetOrgDetail(e,null,!1),_glocalStorage.saveData("orgdata",orgData)),loginData.isowner||(orgData=_gUserService.GetOrgDetail(e,null,!1))}function setBudgetTime(e,a){if($("#"+e+"Time3").html(10>a?"0"+a:""+a),98==a)$("#"+e+"Time1").html("96"),$("#"+e+"Time2").html("97"),$("#"+e+"Time4").html("99"),$("#"+e+"Time5").html("00");else if(99==a)$("#"+e+"Time1").html("97"),$("#"+e+"Time2").html("98"),$("#"+e+"Time4").html("00"),$("#"+e+"Time5").html("01");else if(0==a)$("#"+e+"Time1").html("98"),$("#"+e+"Time2").html("99"),$("#"+e+"Time4").html("01"),$("#"+e+"Time5").html("02");else if(1==a)$("#"+e+"Time1").html("99"),$("#"+e+"Time2").html("00"),$("#"+e+"Time4").html("02"),$("#"+e+"Time5").html("03");else{var t=a-2,i=a-1,o=a+1,n=a+2;$("#"+e+"Time1").html(10>t?"0"+t:""+t),$("#"+e+"Time2").html(10>i?"0"+i:""+i),$("#"+e+"Time4").html(10>o?"0"+o:""+o),$("#"+e+"Time5").html(10>n?"0"+n:""+n)}$("#"+e+"Time1,#"+e+"Time2,#"+e+"Time3,#"+e+"Time4,#"+e+"Time5").fadeIn("slow")}function GetUserData(){onLoadProfile()}function removeDuplicates(e){var a=[];return $.each(e,function(e,t){-1===$.inArray(t,a)&&a.push(t)}),a}function GetSuggestedFunctions(){$("#funcSuggestionList").html("");var e=_glocalStorage.loadData("login"),a=_gUserService.GetSuggestedFunctions(e.orgid,null,!1);if(_glocalStorage.saveData("snfunction",a),null!=a){var t="";if(a.length>0)for(var i=0;i<a.length;i++)t+='<p id="sug_function_'+a[i].functionid+'" onclick="setFunction(this);">'+a[i].functionname+"</p>";else void 0!=a.functionname&&(t+='<p id="sug_function_'+a.functionid+'" onclick="setFunction(this);">'+a.functionname+"</p>");$("#funcSuggestionList").html(t)}}function GetDefaultDrivers(){var e=$("#pre-defined-drivers");if(e.html(""),drivers=_glocalStorage.loadData("drivers"),void 0==drivers&&(drivers=_gUserService.GetDefaultDrivers(null,null,!1),_glocalStorage.saveData("drivers",drivers)),null!=drivers&&drivers.length>0)for(var a=0;a<drivers.length;a++){var t='<div class="driver-select"  ontouchstart="setDriverSelection(&#39;CkBox'+drivers[a].driverid+'&#39);"><span>'+drivers[a].driver+'</span><input disabled type="checkbox" name="one" id="CkBox'+drivers[a].driverid+'" value="'+drivers[a].driverid+'" class="css-checkbox" /><label for="CkBox'+drivers[a].driverid+'" class="css-label"></label></div>';e.append(t)}_glocalStorage.saveData("drivers",drivers)}function GetDefaultKPIs(){var e=$("#kpi-icon-container");e.html("");var a=$("#kpi-list-container");if(a.html(""),kpidata=_glocalStorage.loadData("kpidata"),void 0==kpidata&&(kpidata=_gUserService.GetDefaultKPIs(null,null,!1),_glocalStorage.saveData("kpidata",kpidata)),null!=kpidata&&kpidata.length>0){for(var t='<div style="height: 80px">',i="",o=0;o<kpidata.length;o++){var n=kpidata[o].kpiname.replace(" ","").replace(" ","").replace(" ","").replace(" ","");t+='<span><img id="img_'+n+'" src="assets/img/KPI/'+n+'.png" /></span>',i+='<tr class="col-sm-6"><td style="width:100%; display:block"><table class="kpi-inner-table"><tbody><tr id="KPI_'+n+'" onclick="setKpiSelection(&#39;'+n+'&#39;)"><td><span><img src="assets/img/KPI/'+n+'.png" style="width: 20px;" /></span></td><td><span>'+kpidata[o].kpiname+'</span></td><td><span><input type="checkbox" name="definedKpis" kpiname="'+kpidata[o].kpiname+'" id="'+n+'" value="'+kpidata[o].kpiid+'" class="css-checkbox" disabled /><label for="'+n+'" class="css-label"></label></span></td></tr></tbody></table></td></tr>',defaultKpis.push(kpidata[o].kpiname)}t+="</div>",e.append(t),a.append(i)}_glocalStorage.saveData("kpidata",kpidata)}function DrawLineChart(e,a,t,i,o,n,r){var l={linecolor:"#26C0AB",values:a},s=$(e).SimpleChart({ChartType:"Line",toolwidth:"46",toolheight:"25",axiscolor:"#E6E6E6",textcolor:"#6E6E6E",showlegends:!1,data:[l],legendsize:"140",legendposition:"bottom",xaxislabel:o,yaxislabel:n,showxaxistext:t,showyaxistext:i,yPadding:r});return s}function onAddVendor(e){if(""==$("#vName").val())return void toastr.error("Name should not be empty.");if(""==$("#vEmail").val())return void toastr.error("Email should not be empty.");if(""==$("#vPhone").val())return void toastr.error("Contact number should not be empty.");if(""==$("#vCompany").val())return void toastr.error("Company name should not be empty.");if(!validateEmail($("#vEmail").val()))return void toastr.error("Invalid email address.");var a=checkVendorMailExist($.trim($("#vEmail").val()));if(!a){var t=_glocalStorage.loadData("login"),i=new Vendor;i.vendorname=$("#vName").val(),i.vendoremail=$("#vEmail").val(),i.vendorcompany=$("#vCompany").val(),i.vendorphone=$("#vPhone").val(),i.orgid=parseInt(t.orgid),i.kpimapid=parseInt($("#hdnkpiid").val());var o=new CallBack;o.func="onAddedVendor",$(".load-bar").show(),blockUI("body"),window.setTimeout(function(){var e=_gUserService.AddVendor(i,o,!1);onAddedVendor(e,o),unblockUI("body")},300)}}function onAddedVendor(e,a){if(0!=e.vendorid){$("#myModal").modal("hide");var t='<div class="vendorDiv"><table><tr class="title"><td colspan="2">'+e.vendorcompany+'</td></tr><tr><td class="name">'+e.vendorname+'</td><td class="email">'+e.vendoremail+"</td></tr></table></div>";$("#mainVendor").append(t),toastr.success("Vendor created successfully")}else toastr.error("Something went wrong");$(".load-bar").hide()}function checkVendorMailExist(e){var a=new Vendor,t=_glocalStorage.loadData("login");a.vendoremail=$.trim(e),a.orgid=t.orgid;var i=_gUserService.CheckVendorMailExist(a,null,!1);return i?(isVendorMailExist=!0,toastr.error("Vendor mail already exist in this Organisation")):isVendorMailExist=!1,i}function getDefaultVendorCompany(e){if(!isVendorMailExist){var a=new Vendor;a.vendoremail=$.trim(e);var t=_gUserService.GetVendorByID(a,null,!1);null!=t?($("#vCompany").val(t.vendorcompany),$("#pCompany").val(t.vendorcompany),$("#vCompany").attr("readonly","readonly"),$("#pCompany").attr("readonly","readonly")):($("#vCompany").val(""),$("#pCompany").val(""),$("#vCompany").removeAttr("readonly"),$("#pCompany").removeAttr("readonly"))}}function onAddInnovation(e){if(""==$("#iName").val())return void toastr.error("Name should not be empty.");if(""==$("#iLink").val())return void toastr.error("Link should not be empty.");if(""==$("#iDesc").val())return void toastr.error("Description should not be empty.");var a=new Innovation;a.name=$("#iName").val(),a.link=$("#iLink").val(),a.description=$("#iDesc").val().replace(/\r\n|\r|\n/g,"<br />"),a.kpimapid=parseInt($("#hdnkpiid").val());var t=new CallBack;$("#iName").val(""),$("#iLink").val(""),$("#iDesc").val(""),t.func="onAddedInnovation",_gUserService.AddInnovation(a,t,!0),$(".load-bar").show()}function clear_add_inovation(){$("#iName").val(""),$("#iLink").val(""),$("#iDesc").val("")}function onAddedInnovation(e,a){if(0!=e.innovationid){$("#myInModal").modal("hide");var t='<div class="col-md-6" style="padding: 5px 10px;"><div class="explore-strategic-function-box"><div class="functionUsersContainer" style="margin: 0px; height: 250px;"><div class="functionUserData" style="height: 200px"><div style="padding: 0px 20px; position:relative;"><div class="divFunctionName" style="height: 50px; text-align: left;position:relative;"><span class="divfunname_elpsis1">'+e.name+'</span></div><button data-id="'+e.innovationid+'" onclick="onClickPublishIn(this)" class="btn-blue posbtnabs">Publish </button></div><div  style="padding: 0px 20px;color: #C8CACB;>one minute ago</div><div style="height: 150px; overflow-y: auto; -webkit-overflow-scrolling: touch;"><div style="padding: 15px;"><table style="word-break: break-word; width: 100%;"><tr><td>'+e.description+'</td></tr></table></div></div></div><div class="functionInviteStatus" style="padding: 0px 10px;"><table style="width: 100%; height: 50px;"><tr><td style="width: 10%; text-align: left;"><span><img src="assets/img/attach.png" style="width: 30px" />&nbsp;</span></td><td style="width: 80%; text-align: left;"><span onclick="got_link_confirm(this)" value="'+e.link+'">http://'+e.link+"</a></span></td></tr></table></div></div></div></div>";$("#innovationList").append(t),toastr.success("Innovation created successfully")}else toastr.error("Something went wrong");$(".load-bar").hide()}function got_link_confirm(e){$("#redirect-modal").modal("show"),tempLink="http://"+e.getAttribute("value")}function onClickPublishIn(e){var a=parseInt($(e).data("id")),t=new CallBack;t.func="onPublished",t.data=e;var i=_gUserService.PublishInnovation(a,t,!1);onPublished(i,e)}function onPublished(e,a){e?($(a).html('Published <img src="assets/img/check.png" style="width:22px;" />'),$(a).attr("disabled","disabled"),toastr.success("Innovation published successfully")):toastr.error("Something went wrong")}function changeMenu(e){$("#appMenu").find(".active").removeClass("active"),$("#appMenu").find(e).addClass("active")}function hideKpi(){$("#hdniskpi").val("false")}function onClickLogout(){$(".load-bar").show(),toastr.options={timeOut:0};var e=parseInt(_glocalStorage.loadData("countdata")),a="";e>0&&(a=". Some data has not been synced"),$("#fad").show(),toastr.warning("Are you sure you want to Logout"+a+" <br /><br /><button type='button' onclick='logOutApp()' class='btn clear'>Yes</button><button style='margin-left: 20px;' onclick='resetToast();' type='button' class='btn clear' >No</button>")}function resetToast(){$("#fad").hide(),$(".load-bar").hide(),toastr.remove(),window.setTimeout(function(){toastr.remove(),toastr.options={timeOut:2e3}},500)}function logOutApp(){window.location="nav://,hidebudget",g_nativeScrollVisible=!1,_glocalStorage.saveData("login",void 0),_glocalStorage.saveData("orgdata",void 0),_glocalStorage.saveData("drivers",void 0),_glocalStorage.saveData("kpidata",void 0),_glocalStorage.saveData("userdata",void 0),_glocalStorage.saveData("countdata",0),window.setTimeout(function(){window.location.href="login.html"},1e3)}function DisplayPicture1(){$("#modalImagecrop").modal("show"),encodeImageFileAsURL("regFile1","regAvatar1")}function encodeImageFileAsURL(e,a){var t=document.getElementById(e).files;if(_isiDevice){var i=t[0],o=new FileReader;try{var n=new Image;n.src=webkitURL.createObjectURL(i),o.onload=function(){var e=EXIF.readFromBinaryFile(new BinaryFile(this.result)),t=document.getElementById("photo1"),i=(t.getContext("2d"),new MegaPixImage(n));i.render(t,{orientation:e.Orientation,maxWidth:500}),profilePictureData=t.toDataURL("image/png","");var o=profilePictureData;"regAvatar1"==a||"profileAvatar"==a?(document.getElementById("cropimage").src=o,$("#cropimage").cropbox({width:200,height:200,showControls:"never"}).on("cropbox",function(e,t,i){document.getElementById(a).src=i.getDataURL()})):document.getElementById(a).src=profilePictureData},o.readAsBinaryString(i)}catch(r){}return!0}if(t.length>0){var l=t[0],s=new FileReader;return s.onload=function(t){var i=t.target.result;document.getElementById(e).value=null,document.getElementById(a).src=i,("regAvatar1"==a||"profileAvatar"==a)&&(document.getElementById("cropimage").src=i,$("#cropimage").cropbox({width:200,height:200,showControls:"never"}).on("cropbox",function(e,t,i){document.getElementById(a).src=i.getDataURL()}))},s.readAsDataURL(l),!0}}function onclockcropimg(){$("#modalImagecrop").modal("hide")}function convertFileToDataURLviaFileReader(e,a){var t=new XMLHttpRequest;t.responseType="blob",t.onload=function(){var e=new FileReader;e.onloadend=function(){a(e.result)},e.readAsDataURL(t.response)},t.open("GET",e),t.send()}function editProfile(e){var a=$(e).data("value");$("#pFirstName").val(a.firstname),$("#pLastName").val(a.lastname),$("#pPassword").val(a.password),$("#pTitle").val(a.title),$("#pPhone").val(a.phone),$("#regAvatar1").attr("src",a.image),$("#hdnuserid").val(a.userid)}function onSaveProfile(){if($(".load-bar").show(),""==$("#pFirstName").val())return void toastr.error("First Name should not be be empty");if(""==$("#pLastName").val())return void toastr.error("Last Name should not be empty");if(""==$("#pPassword").val())return void toastr.error("Password should not be empty");if(""==$("#pTitle").val())return void toastr.error("Title should not be empty");if(""==$("#pPhone").val())return void toastr.error("Contact should not be empty");var e=new User;e.firstname=$("#pFirstName").val(),e.lastname=$("#pLastName").val(),e.password=$("#pPassword").val(),e.title=$("#pTitle").val(),e.phone=$("#pPhone").val(),e.image=$("#regAvatar1").attr("src"),e.userid=parseInt($("#hdnuserid").val());var a=new CallBack;a.func="onUpdateProfile",a.data=e;for(var t=_glocalStorage.loadData("login"),i=_glocalStorage.loadData("userdata"),o=0;o<i.length;o++)i[o].userid==e.userid&&(i[o].firstname=e.firstname,i[o].lastname=e.lastname,i[o].password=e.password,i[o].title=e.title,i[o].phone=e.phone,i[o].image=e.image);if(void 0!=i.userid&&(i.firstname=e.firstname,i.lastname=e.lastname,i.password=e.password,i.title=e.title,i.phone=e.phone,i.image=e.image),_glocalStorage.saveData("userdata",i),t.isowner){_glocalStorage.loadData("countdata");cnt++,$("#sync_count").html(cnt),$("#sync_count").show(),_glocalStorage.saveData("countdata",cnt),onUpdateProfile(i,e)}else _gUserService.UpdateProfile(e,a,!0),$(".load-bar").show()}function onUpdateProfile(e,a){null!=e?($("#myprofile1-1").modal("hide"),onLoadProfile(),$("#userMnuProfilePic").attr("src",a.image),$(".load-bar").hide()):toastr.error("Unable to update profile.")}function onClickSync(){var e=_glocalStorage.loadData("orgdata"),a=_glocalStorage.loadData("login");e.orgid=a.orgid,$(".load-bar").show();var t=new CallBack;t.func="onFinishedSync",window.location="nav://,hidebudget",g_nativeScrollVisible=!1,_gUserService.SyncData(e,t,!0)}function onFinishedSync(e,a){null!=e&&_glocalStorage.saveData("orgdata",e);for(var t=_glocalStorage.loadData("login"),i=t.orgid,o=_glocalStorage.loadData("userdata"),n=0;n<o.length;n++)o[n].userid==t.userid&&_gUserService.UpdateProfile(o[n],null,!1);void 0!=o.userid&&_gUserService.UpdateProfile(o,null,!1);var r=_gUserService.GetUsers(i,null,!1);_glocalStorage.saveData("userdata",r),cnt=0,_glocalStorage.saveData("countdata",cnt),$(".load-bar").hide(),$("#sync_count").hide();var l=$(".pt-page-current").attr("id");"page-objective"==l&&"true"==$("#hdniskpi").val().toLowerCase()&&(l="page-kpi"),window.location.hash="?page="+l,window.location.reload()}function addCommasToNumber(e){var a=$("#"+e.id).val(),t=a.toString().split(".");t[0]=t[0].replace(/,/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,","),$("#"+e.id).val(t.join("."))}function showMenuHelp(){var e=_glocalStorage.loadData("login");e.isowner?$("#ceo-menu-help").modal("show"):$("#head-menu-help").modal("show")}function checkKpiExist(){orgData.objectives.length>0&&orgData.functions.length>0?$("#p_kpi").click():toastr.error("Please create atleast one objective/function to view kpi")}var _isiDevice=/ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase()),orgData=null,cnt=0;$(document).ready(function(){$(".content-wrapper").on("click",function(e){$("body").hasClass("sidebar-collapse")||$("body").addClass("sidebar-collapse")});var e=_glocalStorage.loadData("countdata");e>0&&(cnt=e,$("#sync_count").html(cnt),$("#sync_count").show()),$("#budgetStartYear").swipe({swipe:function(e,a,t,i,o){if("right"!=a.toLowerCase()&&"left"!=a.toLowerCase()){$("#stTime1,#stTime2,#stTime3,#stTime4,#stTime5").hide();var n=parseInt($("#stTime3").html());"up"==a.toLowerCase()?(n+=1,n>99&&(n=0)):"down"==a.toLowerCase()&&(n-=1,0>n&&(n=99)),setBudgetTime("st",n)}}}),$("#budgetEndYear").swipe({swipe:function(e,a,t,i,o){if("right"!=a.toLowerCase()&&"left"!=a.toLowerCase()){$("#edTime1,#edTime2,#edTime3,#edTime4,#edTime5").hide();var n=parseInt($("#edTime3").html());"up"==a.toLowerCase()?(n+=1,n>99&&(n=0)):"down"==a.toLowerCase()&&(n-=1,0>n&&(n=99)),setBudgetTime("ed",n)}}}),$("#myCarousel").on("slid.bs.carousel",function(e){var a=$("#obj-list-table").find(".carousel-inner").find(".active").find("span").attr("objectiveid"),t=parseInt($("#hdnCurrentHighlightFunctionId").val());$("#hdnCurrentHighlightObjectiveId").val(a),$("#navigationList").find("table").find("td").css("border",""),$("#ov_nav_"+t+"_"+a).css("border","2px solid #ccc"),GetObjectFunctionKPIMapping(a,t),highlightOverviewNavigation(a,t)}),$("#strategic_myCarousel").on("slid.bs.carousel",function(e){var a=$.trim($("#strategic_myCarousel").find(".carousel-inner").find(".active").find("span").html());"objectives"==a.toLowerCase()?($("#explore-strategic-function-view").hide(),$("#explore-strategic-objective-view").show()):($("#explore-strategic-objective-view").hide(),$("#explore-strategic-function-view").show())}),$("#strategic_Carousel").on("slid.bs.carousel",function(e){var a=$.trim($("#strategic_Carousel").find(".carousel-inner").find(".active").find("span").html());"objectives"==a.toLowerCase()?updateChart(!1):updateChart(!0)}),$("#innovation_myCarousel").on("slid.bs.carousel",function(e){var a=$("#innovation_myCarousel").find(".carousel-inner").find(".active").find(".wrap").attr("objectiveid");(null!=a||void 0!=a)&&GetInnovationLandscapeKPIs(a);var t=$("#innovation_myCarousel").find(".carousel-inner").find(".active").find(".wrap").attr("functionid");(null!=t||void 0!=t)&&GetInnovationLandscapeKPIsbyFunction(t)}),$(".carousel").swipe({swipe:function(e,a,t,i,o,n){"right"==a?$(this).find("[data-slide=prev]").click():"left"==a&&$(this).find("[data-slide=next]").click()},threshold:50});var a=_glocalStorage.loadData("login");null!=a&&(getOrganizationData(a.orgid),GetSuggestedFunctions(),GetDefaultDrivers(),GetDefaultKPIs(),GetUserData()),$("li#p_intro").removeClass("transition");var t=(a.orgid,new CallBack);t.func="onGetUserList",a.isowner||($(".orgonly").css("display","none"),$("#appMenu").find("hr").hide(),$(".pt-page-current").removeClass("pt-page-current"),$("#page-profile").addClass("pt-page-current"),$("#appMenu").find(".active").removeClass("active"),$("#p_intro").addClass("transition"),$("#p_profile").addClass("active"),$(".rem").attr("onclick","").unbind("click"),$("#chImg").attr("src","assets/img/screen2b.png"));var i=getQueryParams(document.location.hash.replace("#",""));if(void 0!=i.page){var o=i.page;"page-profile"==o?$("#p_profile").click():"page-vision"==o?$("#p_vision").click():"page-objective"==o?$("#p_objective").click():"page-budget"==o?$("#p_budget").click():"page-function"==o?$("#p_function").click():"page-kpi"==o?($("#p_kpi").attr("data-id","#page-objective"),$("#p_kpi").click()):"page-explore"==o&&$("#p_explore").click()}$("#sprev").click(),$("#fullLoader").fadeOut(),$("#ceo-menu-help").on("slid.bs.carousel",function(e){var a=$("#ceo-menu-help").find(".carousel-inner").find("div.active").index()+1;$("#ceo-menu-count").html(a)}),$("#ceo-vision-help").on("slid.bs.carousel",function(e){var a=$("#ceo-vision-help").find(".carousel-inner").find("div.active").index()+1;$("#ceo-vision-count").html(a)}),$("#ceo-objective-help").on("slid.bs.carousel",function(e){var a=$("#ceo-objective-help").find(".carousel-inner").find("div.active").index()+1;$("#ceo-objective-count").html(a)}),$("#ceo-budget-help").on("slid.bs.carousel",function(e){var a=$("#ceo-budget-help").find(".carousel-inner").find("div.active").index()+1;$("#ceo-budget-count").html(a)}),$("#ceo-function-help").on("slid.bs.carousel",function(e){var a=$("#ceo-function-help").find(".carousel-inner").find("div.active").index()+1;$("#ceo-function-count").html(a)}),$("#ceo-kpi-help").on("slid.bs.carousel",function(e){var a=$("#ceo-kpi-help").find(".carousel-inner").find("div.active").index()+1;$("#ceo-kpi-count").html(a)}),$("#ceo-explore-help").on("slid.bs.carousel",function(e){var a=$("#ceo-explore-help").find(".carousel-inner").find("div.active").index()+1;$("#ceo-explore-count").html(a)}),$("#ceo-profile-help").on("slid.bs.carousel",function(e){var a=$("#ceo-profile-help").find(".carousel-inner").find("div.active").index()+1;$("#ceo-profile-count").html(a)}),$("#head-explore-help").on("slid.bs.carousel",function(e){var a=$("#head-explore-help").find(".carousel-inner").find("div.active").index()+1;$("#head-explore-count").html(a)}),$("#head-profile-help").on("slid.bs.carousel",function(e){var a=$("#head-profile-help").find(".carousel-inner").find("div.active").index()+1;$("#head-profile-count").html(a)}),$(".carousel").carousel({interval:!1})});var defaultKpis=[],isVendorMailExist=!1,tempLink=null;