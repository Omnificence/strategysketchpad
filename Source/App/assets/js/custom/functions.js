function onLoadFunction(){$(".load-bar").show(),GetFunctions(),$(".load-bar").hide()}function GetFunctions(){clearFunctionEntries();var n=[];n=orgData.functions,populateFunctionData(n)}function populateFunctionData(n){if($("#functionContainer").find("#functionList").html(""),functionDatas="",null!=n){if(n.length>0)for(var t=0;t<n.length;t++)generateFunctionColumns(n[t]);else generateFunctionColumns(n);$("#functionContainer").find("#functionList").html(functionDatas),$(".functionUserData").swipe({hold:function(n,t){$(this).find(".fncrossmark").show()},longTapThreshold:1e3}),document.getElementById("functionContainer").addEventListener("click",function(){$(".fncrossmark").hide()})}var a=$("#login_user_email").html(),o=a.split("@"),i=o[1],e="@"+i;$("#memail").html(e)}function generateFunctionColumns(n){var t=n.functionid;if(void 0!=t){var a=1==n.isinvited?'<span style="border: none; color: #000;">Invited</span>':'<span onclick="InviteFunctionHead(&#39;'+n.email+"&#39;, &#39;"+(n.firstname+" "+(void 0==n.lastname?"":n.lastname))+"&#39;,"+n.functionid+","+n.ownerid+')">Invite</span>';functionDatas+='<div class="col-md-4"><div class="functionUsersContainer"><div class="functionUserData"><span class="fncrossmark" onclick="deleteFunction('+n.functionid+')"><img src="assets/img/close.png" style="width: 25px;" /></span><div class="divFunctionName"><span class="functionname_elipsis">'+n.functionname+'</span></div><div class="divFunctionUsers"><table style="word-break: break-word;"><tr><td><span><img src="assets/img/profile_2.png" style="width: 30px" /></span></td><td><p class="txtell" style="text-transform: capitalize;">'+n.firstname+" "+(void 0==n.lastname?"":n.lastname)+'</p></td></tr><tr><td><span><img src="assets/img/mail.png" style="width: 30px" />&nbsp;</span></td><td><span class="elipsisdot">'+n.email+'</span></td></tr></table></div></div><div class="functionInviteStatus"><table><tr><td><div class="userInvite">'+a+'</div></td><td><span onclick="editFunction('+n.functionid+')"><img src="assets/img/edit.png" style="width: 35px" /></span></td><td></td></tr></table></div></div></div>'}else $("#noFunctions").show()}function setFunction(n){$("#funcSuggestionList").find("p").css("color","#57C1B7");var t=n.innerText;selectedFunctionName=t,$(n).css("color","orange")}function chooseFunctionName(){return""==selectedFunctionName?void toastr.error("Please select a function name from the suggestion list"):($("#newFunctionText").val(selectedFunctionName),selectedFunctionName="",void $("#funcSuggestionList").find("p").css("color","#57C1B7"))}function editFunction(n){isEdit=!0,$("#hdnFunctionId").val(n),$("#hdnFunctionIndex").val(n);var t=_glocalStorage.loadData("orgdata"),a=t,o=0;if(null!=a)for(o=0;o<a.functions.length;o++)if(a.functions[o].functionid==n){$("#hdnFunctionIndex").val(o),$("#hdnFunctionId").val(n),$("#newFunctionText").val(a.functions[o].functionname),$("#f_firstName").val(a.functions[o].firstname+" "+(void 0==a.functions[o].lastname?"":a.functions[o].lastname)),$("#f_eMail").val(a.functions[o].email);var i=$("#f_eMail").val(),e=i.split("@"),s=e[0];$("#f_eMail").val(s)}}function deleteFunction(n){$(".load-bar").show(),toastr.options={timeOut:0},$("#fad").show(),toastr.warning("Deleting Function will delete all associated users and data. Confirm delete function?<br /><br /><button type='button' onclick='delF("+n+")' class='btn clear'>Yes</button><button style='margin-left: 20px;' onclick='resetToast();' type='button' class='btn clear' >No</button>")}function delF(n){if(resetToast(),$(".load-bar").show(),orgData=_glocalStorage.loadData("orgdata"),null!=orgData.kpis)for(var t=0;t<orgData.kpis.length;t++)if(orgData.kpis[t].functionid==n){var t=orgData.kpis.indexOf(orgData.kpis[t]);t>-1&&orgData.kpis.splice(t,1)}_glocalStorage.saveData("orgdata",orgData);for(var t=0;t<orgData.functions.length;t++)if(orgData.functions[t].functionid==n){var t=orgData.functions.indexOf(orgData.functions[t]);t>-1&&orgData.functions.splice(t,1)}_glocalStorage.saveData("orgdata",orgData);_glocalStorage.loadData("countdata");cnt++,$("#sync_count").html(cnt),$("#sync_count").show(),_glocalStorage.saveData("countdata",cnt),toastr.success("Function has been deleted."),$(".load-bar").hide(),GetFunctions()}function addNewFunction(){var n=$.trim($("#newFunctionText").val());if(0==n.length)return void toastr.error("Function name should not be empty");var t=$.trim($("#f_firstName").val());if(0==t.length)return void toastr.error("First name should not be empty");var a=t.split(" "),o="";void 0!=a.length&&(o=o[o.length-1]),t=$.trim(t.replace(o,""));var i=$("#login_user_email").html(),e=i.split("@"),s=e[1],c=$.trim($("#f_eMail").val());if(c+="@"+s,0==c.length)return void toastr.error("Owner email should not be empty");if(!validateEmail(c))return void toastr.error("Invalid email address.");var l=c.split("@"),r=l[1];if(r==s){var u=_glocalStorage.loadData("login"),d=new Function;if(isEdit){var f=parseInt($("#hdnFunctionIndex").val());orgData.functions[f].functionid=parseInt($("#hdnFunctionId").val()),orgData.functions[f].functionname=n,orgData.functions[f].firstname=t,orgData.functions[f].lastname=o,orgData.functions[f].email=c}else{d.functionid=0,d.orgid=u.orgid,d.functionname=n,d.firstname=t,d.lastname=o,d.email=c;for(var f=0;f<orgData.functions.length;f++)fnid==orgData.functions[f].functionid&&fnid--;var g=new objFunction;g.functionid=fnid,g.orgid=d.orgid,g.functionname=d.functionname,g.firstname=d.firstname,g.lastname=d.lastname,g.email=d.email,orgData.functions.push(g)}var m=new CallBack;m.func="onSuccessFunctionCreation",$(".load-bar").show(),_glocalStorage.saveData("orgdata",orgData);_glocalStorage.loadData("countdata");cnt++,$("#sync_count").html(cnt),$("#sync_count").show(),_glocalStorage.saveData("countdata",cnt),isEdit?toastr.success("Function updated successfully"):toastr.success("Function created successfully"),$(".load-bar").hide()}else toastr.error("Domain name must be the same as loged in user");$(".check-icon-blue2").hide(),$("#noFunctions").hide(),GetFunctions()}function onSuccessFunctionCreation(n,t){if($(".load-bar").show(),n.functionid>0){isEdit?toastr.success("Function updated successfully"):toastr.success("Function created successfully");var a=_glocalStorage.loadData("login");getOrganizationData(a.orgid),GetFunctions()}else toastr.error("Something went wrong");$("#noFunctions").hide(),$(".load-bar").hide()}function clearFunctionEntries(){$("#newFunctionText").val(""),$("#f_firstName").val(""),$("#f_lastName").val(""),$("#f_eMail").val(""),isEdit=!1,$("#hdnFunctionId").val("0")}function InviteFunctionHead(n,t,a,o){var i=new Function;i.functionid=parseInt(a),i.email=n,i.firstname=t,i.ownerid=o,orgData=_glocalStorage.loadData("orgdata");for(var e=0;e<orgData.functions.length;e++)if(orgData.functions[e].functionid==i.functionid){var s=_glocalStorage.loadData("login");getOrganizationData(s.orgid),toastr.success("Invitation will be sent once synchronized"),orgData.functions[e].isinvited=!0,_glocalStorage.saveData("orgdata",orgData);_glocalStorage.loadData("countdata");cnt++,$("#sync_count").html(cnt),$("#sync_count").show(),_glocalStorage.saveData("countdata",cnt),GetFunctions()}}function editFunction1(){$(".check-icon-gray2").hide(),$(".check-icon-blue2").show()}var selectedFunctionName="",isEdit=!1,functionDatas="",fnid=-1;