function onClickContinue(){if(""==$("#txtEmail").val()&&""==$("#txtInvCode").val())return void toastr.error("Please enter email address or invitation code to proceed.");if(""!=$("#txtEmail").val()){if(!validateEmail($("#txtEmail").val()))return void toastr.error("Invalid email address.");_email=null,_email=$("#txtEmail").val(),$("#beforeLogin").hide(),$("#loginTable").show(),$("#Email").html(_email)}if(""!=$("#txtInvCode").val()){blockUI("#beforeLogin");var n=new CallBack;n.func="onVerifiedCode",_gUserService.GetVendorByCode($("#txtInvCode").val(),n,!0)}}function onVerifiedCode(n,i){return unblockUI("#beforeLogin"),null==n?void toastr.error("Invalid invitation code"):void(n.isactive?toastr.error("User already registered. Please login to add invitecode"):($("#hdnInvitationCode").val($("#txtInvCode").val()),$("#beforeLogin").hide(),$("#loginTable").show(),$("#Email").html(n.vendoremail),_email=n.vendoremail))}function onClickEnter(){if(""==$("#txtPass").val())return void toastr.error("Password should not be empty.");var n=new Vendor;n.vendoremail=_email,n.password=$("#txtPass").val(),n.invitecode=$("#hdnInvitationCode").val();var i=new CallBack;i.func="onAuthendication",_gUserService.AuthenticateVendor(n,i,!0),blockUI("#loginTable")}function onAuthendication(n,i){unblockUI("#loginTable"),null!=n?window.location.href="Innovation.aspx":toastr.error("Invalid username/password.")}function onLoadInnovation(){var n=new Vendor;n.vendorid=parseInt($("#hdnVendorId").val());var i=_gUserService.GetVendorOrganization(n,null,!1);if(null!=i){var e=i.vendor,t=i.organizations;i.kpis;if(null!=e&&e.length>0&&($("#vName").html(e[0].vendorname),$("#cName").html(e[0].vendorcompany),$("#vEmail").html(e[0].vendoremail),$("#vCNO").html(e[0].vendorphone),$("#venName").val(e[0].vendorname),$("#venPhone").val(e[0].vendorphone),$("#hdnCmp").val(e[0].vendorcompany.replace(/ /g,"_")),n.vendorcompany=e[0].vendorcompany,vendorFunctions=_gUserService.GetVendorDetails(n,null,!1)),null!=t&&t.length>0){for(var l="",o="",a=0;a<t.length;a++){var s=0;if(null!=vendorFunctions)if(void 0!=vendorFunctions.functionname)parseInt(vendorFunctions.orgid)==parseInt(t[a].orgid)&&(s+=1);else for(var d=0;d<vendorFunctions.length;d++)parseInt(vendorFunctions[d].orgid)==parseInt(t[a].orgid)&&(s+=1);var r=t[a].organization;if(l+='<li id="tabOrgId'+t[a].orgid+'"><a id="aOrgId'+t[a].orgid+'" onclick="onClickOrganization(this)" href="#'+r.replace(" ","_").replace(" ","_").replace(" ","_")+'" data-toggle="tab">'+r+"</a></li>",o+='<div class="tab-pane" id="'+r.replace(" ","_").replace(" ","_").replace(" ","_")+'"><div class="kpisDiv"><div class="row"><div class="col-md-12" style="background: white;"><span class="col-blue" style="position: relative; top: 10px;">List of Innovation Request</span><span class="t-requests" id="totalrequests" style="position: relative; top: 10px;"> ('+s+' Request in Total) </span><hr /></div></div><div class="row scrolltab">',null!=vendorFunctions)if(void 0!=vendorFunctions.functionname)parseInt(vendorFunctions.orgid)==parseInt(t[a].orgid)&&(o+=generateKpiDiv(vendorFunctions));else for(var d=0;d<vendorFunctions.length;d++)parseInt(vendorFunctions[d].orgid)==parseInt(t[a].orgid)&&(o+=generateKpiDiv(vendorFunctions[d]));o+='</div></div><div class="invDiv"></div></div>'}$("#invTab").html(l),$("#invCont").html(o),$("#tabOrgId"+t[0].orgid).addClass("active"),$("#"+t[0].organization.replace(/ /g,"_")).addClass("active"),$("#hdnOrg").val($("#aOrgId"+t[0].orgid).html())}}}function generateKpiDiv(n){var i="<div class='col-md-6' style='padding-top: 10px; padding-bottom: 10px; cursor: pointer' data-value='"+JSON.stringify(n)+"' onclick='onclickKpi("+n.kpimapid+", this)'><div class='content-box row'><div class='col-md-12'><span class='col-blue'>"+n.functionname+"</span></div><div class='col-md-12'><div class='con-title'>"+n.kpiname+"</div><hr /></div><div class='col-md-12'><span class='con-description'>"+n.description+"</span></div></div></div>";return i}function onClickOrganization(n){$("#hdnOrg").val($(n).html()),$(".invDiv").hide(),$(".kpisDiv").show()}function onclickKpi(n,i){unPublishedInnovations=[];var e=$(i).parents().find(".invDiv");$("#hdnKpiId").val(n);var t=$(i).data("value"),l=0,o=[],a=0,s="",d=_gUserService.GetInnovationList(n,null,!1);if(null!=d)if(void 0!=d.kpimapid)parseInt(d.vendorid)==parseInt($("#hdnVendorId").val())&&o.push(d);else if(d.length>0)for(var r=0;r<d.length;r++)parseInt(d[r].vendorid)==parseInt($("#hdnVendorId").val())&&o.push(d[r]);a=o.length;for(var r=0;r<o.length;r++){o[r].ispublished&&l++,s+="<table class='w-100 innovTable'><tr><td colspan='2'><div class='cinvData'>"+JSON.stringify(o[r])+"</div><span class='col-blue'>"+o[r].name+"</span><span class='t-requests'></span></td><td>",o[r].ispublished?s+='<img src="images/check.png" style="width: 32px;float: right;" />':(s+='<input type="button" class="white-sm-btn pull-right" onclick="onclickpublish(this)" value="Publish" style="display: block" id="btn-publish" />',unPublishedInnovations.push(o[r].innovationid));var v=o[r].link.length>22?o[r].link.substr(0,20)+"...":o[r].link;s+='</td></tr><tr><td class="mb-1" colspan="3">'+o[r].description+'</td></tr><tr><td><span><img src="images/attach.png" style="width: 15px" /></span><span class="t-requests" style="cursor: pointer;" value="'+o[r].link+'" onclick="redirectAlert(this)">'+v+"</span></td>",s+=o[r].ispublished?'<td class="wbord disabled">':'<td onclick="onClickEditInnov(this);" class="wbord">',s+='<span class="spl-btn" id="edit-publish-btn"><img src="images/edit.png" style="width: 20px" />Edit</span></td>',s+=o[r].ispublished?'<td class="wbord disabled">':'<td onclick="onClickDeleteInnov(this);" class="wbord">',s+='<span id="delete-publish-btn" class="spl-btn"><img src="images/delete.png" style="width: 20px;" /> Delete</span></td></tr></table>'}var c='<div class="row"><div class="col-md-12 h-100" style="background: white;"><table class="kpitable"><tr><td class="first"><img src="images/left_arrow.png" onclick="onclickbackinv(this)" style="width: 50px; cursor: pointer;" id="back-gravity-inner-1" /></td><td><div class="col-blue">'+t.functionname+'</div><div class="con-title">'+t.kpiname+'</div><br /><div class="t-requests">'+t.description+'</div></td></tr></table><div class="col-md-12 inv-deta-div"><div class="col-md-6"><div class="col-12"><span class="con-title" style="font-weight: lighter"><span id="dsubcount">'+a+'</span> Submitted Innovations</span></div><div class="col-12"><span class="con-title" style="font-weight: lighter"><span id="dpubcount">'+l+'</span> Published Innovations</span></div></div><div class="col-md-6"><div class="col-md-6"><input type="button" onclick="onClickCreateInv()" value="Add Innovation" class="blue-sm-btn" /></div><div class="col-md-6"><input type="button" class="white-sm-btn" value="Publish All" id="btn-publish-all" onclick="onClickPublishAll()" /></div></div></div><div class="col-md-12 innovDiv">'+s+"</div></div></div>";$(e).html(c),$(i).parents().find(".kpisDiv").hide(),$(e).show()}function onLoadInnerInnovation(){if(null!=vendorFunctions)if(void 0!=vendorFunctions.functionname)vendorFunctions.kpimapid==parseInt($("#hdnKpiId").val())&&ReloadKpi(vendorFunctions.kpimapid,"#"+$("#hdnOrg").val(),vendorFunctions);else for(var n=0;n<vendorFunctions.length;n++)vendorFunctions[n].kpimapid==parseInt($("#hdnKpiId").val())&&ReloadKpi(vendorFunctions[n].kpimapid,"#"+$("#hdnOrg").val(),vendorFunctions[n])}function ReloadKpi(n,i,e){unPublishedInnovations=[];var t=$(i).find(".invDiv");$("#hdnKpiId").val(n);var l=0,o=[],a=0,s="",d=_gUserService.GetInnovationList(n,null,!1);if(null!=d)if(void 0!=d.kpimapid)parseInt(d.vendorid)==parseInt($("#hdnVendorId").val())&&o.push(d);else if(d.length>0)for(var r=0;r<d.length;r++)parseInt(d[r].vendorid)==parseInt($("#hdnVendorId").val())&&o.push(d[r]);a=o.length;for(var r=0;r<o.length;r++){o[r].ispublished&&l++,s+="<table class='w-100 innovTable'><tr><td colspan='2'><div class='cinvData'>"+JSON.stringify(o[r])+"</div><span class='col-blue'>"+o[r].name+"</span><span class='t-requests'></span></td><td>",o[r].ispublished?s+='<img src="images/check.png" style="width: 32px;float: right;" />':(s+='<input type="button" class="white-sm-btn pull-right" onclick="onclickpublish(this)" value="Publish" style="display: block" id="btn-publish" />',unPublishedInnovations.push(o[r].innovationid));var v=o[r].link.length>22?o[r].link.substr(0,20)+"...":o[r].link;s+='</td></tr><tr><td class="mb-1" colspan="3">'+o[r].description+'</td></tr><tr><td><span><img src="images/attach.png" style="width: 15px" /></span><span class="t-requests" style="cursor: pointer;" value="'+o[r].link+'" onclick="redirectAlert(this)">'+v+"</span></td>",s+=o[r].ispublished?'<td class="wbord disabled">':'<td onclick="onClickEditInnov(this);" class="wbord">',s+='<span class="spl-btn" id="edit-publish-btn"><img src="images/edit.png" style="width: 20px" />Edit</span></td>',s+=o[r].ispublished?'<td class="wbord disabled">':'<td onclick="onClickDeleteInnov(this);" class="wbord">',s+='<span id="delete-publish-btn" class="spl-btn"><img src="images/delete.png" style="width: 20px;" /> Delete</span></td></tr></table>'}var c='<div class="row"><div class="col-md-12 h-100" style="background: white;"><table class="kpitable"><tr><td class="first"><img src="images/left_arrow.png" onclick="onclickbackinv(this)" style="width: 50px; cursor: pointer;" id="back-gravity-inner-1" /></td><td><div class="col-blue">'+e.functionname+'</div><div class="con-title">'+e.kpiname+'</div><br /><div class="t-requests">'+e.description+'</div></td></tr></table><div class="col-md-12 inv-deta-div"><div class="col-md-6"><div class="col-12"><span class="con-title" style="font-weight: lighter"><span id="dsubcount">'+a+'</span> Submitted Innovations</span></div><div class="col-12"><span class="con-title" style="font-weight: lighter"><span id="dpubcount">'+l+'</span> Published Innovations</span></div></div><div class="col-md-6"><div class="col-md-6"><input type="button" onclick="onClickCreateInv()" value="Add Innovation" class="blue-sm-btn" /></div><div class="col-md-6"><input type="button" class="white-sm-btn" value="Publish All" id="btn-publish-all" onclick="onClickPublishAll()" /></div></div></div><div class="col-md-12 innovDiv">'+s+"</div></div></div>";$(t).html(c),$(i).parents().find(".kpisDiv").hide(),$(t).show()}function onClickPublishAll(){unPublishedInnovations.length>0?$("#publish-all-post-modal").modal("show"):$("#no-publish").modal("show")}function onClickPublishAllConfirmation(){unPublishedInnovations.length>0?(blockUI("body"),window.setTimeout(function(){for(var n=0;n<unPublishedInnovations.length;n++)_gUserService.PublishInnovation(parseInt(unPublishedInnovations[n]),null,!1);$("#btnUpdatePanel").click(),toastr.success("All Innovations has been published successfully."),$("#publish-all-post-modal").modal("hide"),unblockUI("body"),pageLoad()},300)):$("#publish-all-post-modal").modal("hide")}function onclickpublish(n){var i=JSON.parse($(n).parents("table").find(".cinvData").html());$("#publish-post-modal").modal("show"),$("#publish-post-modal").find("#invTit").html(i.name),$("#publish-post-modal").find("#invDes").html(i.description),$("#publish-post-modal").find("#invLin").html(i.link),$("#hdnInvId").val(i.innovationid),$("#publish-post-modal").find("#pub").show(),$("#publish-post-modal").find("#del").hide(),pageLoad()}function onClickDeleteInnov(n){var i=JSON.parse($(n).parents("table").find(".cinvData").html());$("#publish-post-modal").modal("show"),$("#publish-post-modal").find("#invTit").html(i.name),$("#publish-post-modal").find("#invDes").html(i.description),$("#publish-post-modal").find("#invLin").html(i.link),$("#hdnInvId").val(i.innovationid),$("#publish-post-modal").find("#del").show(),$("#publish-post-modal").find("#pub").hide(),pageLoad()}function onClickCreateInv(){$("#editInv").modal("show"),$("#invTitle").val(""),$("#invDesc").val(""),$("#invLink").val(""),$("#hdnInvId").val(0)}function onClickEditInnov(n){var i=JSON.parse($(n).parents("table").find(".cinvData").html());$("#editInv").modal("show"),$("#invTitle").val(i.name),$("#invDesc").val(i.description.replace(/<br\s*[\/]?>/gi,"\n")),$("#invLink").val(i.link),$("#hdnInvId").val(i.innovationid)}function onclickbackinv(n){$(n).parents().find(".kpisDiv").show(),$(n).parents().find(".invDiv").hide()}function onClickAddInnov(){if(""==$("#invTitle").val())return void toastr.error("Please enter innovation title.");if(""==$("#invDesc").val())return void toastr.error("Please enter innovation description.");if(""==$("#invLink").val())return void toastr.error("Please enter innovation link.");var n=new Innovation;n.name=$("#invTitle").val(),n.link=$("#invLink").val(),n.description=$("#invDesc").val().replace(/\r\n|\r|\n/g,"<br />"),n.kpimapid=parseInt($("#hdnKpiId").val()),n.vendorid=parseInt($("#hdnVendorId").val()),n.innovationid=parseInt($("#hdnInvId").val());var i=new CallBack;i.func="onAddedInnovation",blockUI("body"),window.setTimeout(function(){var i=_gUserService.AddInnovation(n,null,!1);onAddedInnovation(i)},300)}function onAddedInnovation(n){n&&($("#btnUpdatePanel").click(),toastr.success("Innovation saved successfully."),$("#editInv").modal("hide")),unblockUI("body"),pageLoad()}function onClickPub(){var n=new CallBack;n.func="onPublishedInnovation",_gUserService.PublishInnovation(parseInt($("#hdnInvId").val()),n,!0),blockUI("#edmod")}function onPublishedInnovation(n,i){n&&($("#btnUpdatePanel").click(),toastr.success("Innovation published successfully."),$("#publish-post-modal").modal("hide")),unblockUI("#edmod"),pageLoad()}function onClickDel(){var n=new CallBack;n.func="onDeleteInnovation",_gUserService.DeleteInnovation(parseInt($("#hdnInvId").val()),n,!0),blockUI("#edmod")}function onDeleteInnovation(n,i){n&&($("#btnUpdatePanel").click(),toastr.success("Innovation deleted successfully."),$("#publish-post-modal").modal("hide")),unblockUI("#edmod"),pageLoad()}function onClickEditVendor(){$("#editven").modal("show");var n=JSON.parse($("#hdnVendor").val());$("#venName").val(n.vendorname),$("#venPhone").val(n.vendorphone)}function onClickSaveVendor(){if(""==$("#venName").val())return void toastr.error("Please enter name.");if(""==$("#venPhone").val())return void toastr.error("Please enter phone.");var n=new Vendor;n.vendorid=parseInt($("#hdnVendorId").val()),n.vendorname=$("#venName").val(),n.vendorphone=$("#venPhone").val();var i=new CallBack;i.func="onAddedVendor",i.data=n,_gUserService.UpdateVendor(n,i,!0)}function onAddedVendor(n,i){n&&($("#editven").modal("hide"),$("#btnUpdatePanel").click(),toastr.success("Vendor updated successfully."),$("#vName").html(i.vendorname),$("#vCNO").html(i.vendorphone))}function redirectAlert(n){tempLink="http://"+n.getAttribute("value"),$("#redirect-modal").modal("show")}function redirectToLink(){$("#redirect-modal").modal("hide"),null!=tempLink&&window.open(tempLink,"_blank")}var _invCode=null,_email=null,unPublishedInnovations=[],vendorFunctions=null,tempLink=null;